{
  "ServiceControlPolicies": {
    "HIPAA_Compliance_Policy": {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Sid": "DenyNonHIPAACompliantServices",
          "Effect": "Deny",
          "Action": [
            "s3:PutObject",
            "dynamodb:PutItem",
            "rds:CreateDBInstance"
          ],
          "Resource": "*",
          "Condition": {
            "StringNotEquals": {
              "aws:RequestedRegion": [
                "us-east-1",
                "us-west-2"
              ]
            }
          }
        },
        {
          "Sid": "RequireEncryptionAtRest",
          "Effect": "Deny",
          "Action": [
            "s3:PutObject",
            "dynamodb:CreateTable",
            "rds:CreateDBInstance",
            "ebs:CreateVolume"
          ],
          "Resource": "*",
          "Condition": {
            "StringNotEquals": {
              "s3:x-amz-server-side-encryption": [
                "aws:kms",
                "AES256"
              ]
            }
          }
        },
        {
          "Sid": "RequireEncryptionInTransit",
          "Effect": "Deny",
          "Action": [
            "s3:*",
            "dynamodb:*"
          ],
          "Resource": "*",
          "Condition": {
            "Bool": {
              "aws:SecureTransport": "false"
            }
          }
        },
        {
          "Sid": "DenyPublicAccessToHealthcareData",
          "Effect": "Deny",
          "Action": [
            "s3:PutBucketPublicAccessBlock",
            "s3:PutAccountPublicAccessBlock"
          ],
          "Resource": "*",
          "Condition": {
            "StringEquals": {
              "s3:x-amz-acl": [
                "public-read",
                "public-read-write"
              ]
            }
          }
        },
        {
          "Sid": "RequireCloudTrailLogging",
          "Effect": "Deny",
          "Action": [
            "cloudtrail:StopLogging",
            "cloudtrail:DeleteTrail"
          ],
          "Resource": "*"
        },
        {
          "Sid": "RequireMFAForSensitiveActions",
          "Effect": "Deny",
          "Action": [
            "iam:DeleteUser",
            "iam:DeleteRole",
            "kms:ScheduleKeyDeletion",
            "rds:DeleteDBInstance",
            "dynamodb:DeleteTable"
          ],
          "Resource": "*",
          "Condition": {
            "BoolIfExists": {
              "aws:MultiFactorAuthPresent": "false"
            }
          }
        }
      ]
    },
    "Data_Residency_Policy": {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Sid": "RestrictRegionsForPHI",
          "Effect": "Deny",
          "Action": [
            "s3:CreateBucket",
            "dynamodb:CreateTable",
            "rds:CreateDBInstance",
            "ec2:RunInstances"
          ],
          "Resource": "*",
          "Condition": {
            "StringNotEquals": {
              "aws:RequestedRegion": [
                "us-east-1",
                "us-west-2"
              ]
            }
          }
        }
      ]
    },
    "Audit_And_Monitoring_Policy": {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Sid": "PreventDisablingSecurityServices",
          "Effect": "Deny",
          "Action": [
            "guardduty:DeleteDetector",
            "guardduty:DisassociateFromMasterAccount",
            "securityhub:DisableSecurityHub",
            "config:DeleteConfigurationRecorder",
            "config:StopConfigurationRecorder"
          ],
          "Resource": "*"
        },
        {
          "Sid": "RequireVPCFlowLogs",
          "Effect": "Deny",
          "Action": [
            "ec2:DeleteFlowLogs"
          ],
          "Resource": "*"
        }
      ]
    },
    "Access_Control_Policy": {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Sid": "PreventRootAccountUsage",
          "Effect": "Deny",
          "Action": "*",
          "Resource": "*",
          "Condition": {
            "StringLike": {
              "aws:PrincipalArn": "arn:aws:iam::*:root"
            }
          }
        },
        {
          "Sid": "RequireTagsForResources",
          "Effect": "Deny",
          "Action": [
            "ec2:RunInstances",
            "s3:CreateBucket",
            "dynamodb:CreateTable"
          ],
          "Resource": "*",
          "Condition": {
            "StringNotLike": {
              "aws:RequestTag/Environment": [
                "production",
                "staging",
                "development"
              ]
            }
          }
        }
      ]
    },
    "Cost_Control_Policy": {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Sid": "PreventExpensiveInstanceTypes",
          "Effect": "Deny",
          "Action": [
            "ec2:RunInstances"
          ],
          "Resource": "arn:aws:ec2:*:*:instance/*",
          "Condition": {
            "StringNotLike": {
              "ec2:InstanceType": [
                "t3.*",
                "t4g.*",
                "m5.*",
                "r5.*"
              ]
            }
          }
        }
      ]
    },
    "NIST_800_53_Compliance_Policy": {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Sid": "RequirePrivateSubnetsForPHI",
          "Effect": "Deny",
          "Action": [
            "rds:CreateDBInstance",
            "dynamodb:CreateTable"
          ],
          "Resource": "*",
          "Condition": {
            "Bool": {
              "rds:PubliclyAccessible": "true"
            }
          }
        },
        {
          "Sid": "RequireBackupRetention",
          "Effect": "Deny",
          "Action": [
            "rds:ModifyDBInstance",
            "dynamodb:UpdateContinuousBackups"
          ],
          "Resource": "*",
          "Condition": {
            "NumericLessThan": {
              "rds:BackupRetentionPeriod": "7"
            }
          }
        }
      ]
    }
  }
}
