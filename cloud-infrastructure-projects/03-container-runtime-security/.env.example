# Environment Configuration for Container Runtime Security Platform
# Copy to .env and customize for your environment

# ============================================================
# Application Settings
# ============================================================
APP_NAME=container-runtime-security
APP_ENV=production
DEBUG=false
LOG_LEVEL=info

# ============================================================
# Elasticsearch Configuration
# ============================================================
ELASTICSEARCH_HOST=elasticsearch
ELASTICSEARCH_PORT=9200
ELASTICSEARCH_USER=elastic
ELASTICSEARCH_PASSWORD=changeme
ELASTICSEARCH_SCHEME=http

# Index settings
ES_INDEX_PREFIX=falco
ES_INDEX_REPLICAS=1
ES_INDEX_SHARDS=3
ES_RETENTION_DAYS=90

# ============================================================
# Kibana Configuration
# ============================================================
KIBANA_HOST=kibana
KIBANA_PORT=5601
KIBANA_USER=kibana
KIBANA_PASSWORD=changeme

# ============================================================
# Prometheus Configuration
# ============================================================
PROMETHEUS_HOST=prometheus
PROMETHEUS_PORT=9090
PROMETHEUS_RETENTION=30d

# ============================================================
# Grafana Configuration
# ============================================================
GRAFANA_HOST=grafana
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_ENABLE_OAUTH=false
GF_SECURITY_ADMIN_PASSWORD=admin

# ============================================================
# Falco Configuration
# ============================================================
FALCO_LOG_LEVEL=info
FALCO_ALERT_RATE_LIMIT=100
FALCO_MAX_BURST=5000

# Enable specific outputs
FALCO_JSON_OUTPUT=true
FALCO_FILE_OUTPUT=true
FALCO_SYSLOG_OUTPUT=false
FALCO_HTTP_OUTPUT=false
FALCO_GRPC_OUTPUT=true
FALCO_GRPC_BIND_ADDRESS=0.0.0.0:5060

# ============================================================
# Email/Notification Settings
# ============================================================
SMTP_HOST=smtp.company.com
SMTP_PORT=587
SMTP_USER=notifications@company.com
SMTP_PASSWORD=changeme
SMTP_FROM=falco-alerts@company.com
SMTP_TLS=true

# ============================================================
# Slack Integration
# ============================================================
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_CHANNEL=#security-alerts
SLACK_USERNAME=Falco Security
SLACK_ICON_EMOJI=ðŸš¨

# ============================================================
# PagerDuty Integration
# ============================================================
PAGERDUTY_ENABLED=false
PAGERDUTY_SERVICE_KEY=your-service-key-here
PAGERDUTY_INCIDENT_PRIORITY=high

# ============================================================
# Network Configuration
# ============================================================
NETWORK_SUBNET=172.20.0.0/16
SAMPLE_APP_PORT=8080
PROMETHEUS_UI_PORT=9090
GRAFANA_UI_PORT=3000
KIBANA_UI_PORT=5601
ELASTICSEARCH_PORT=9200

# ============================================================
# Security Configuration
# ============================================================
# Enable container isolation
ENABLE_NETWORK_POLICIES=true

# Enable compliance checks
ENABLE_COMPLIANCE_MONITORING=true

# Compliance frameworks to monitor
COMPLIANCE_FRAMEWORKS=pci-dss,hipaa,soc2,cis

# ============================================================
# Vulnerability Scanning
# ============================================================
TRIVY_ENABLED=true
TRIVY_SEVERITY=HIGH,CRITICAL
TRIVY_FORMAT=json
TRIVY_TIMEOUT=5m
TRIVY_OFFLINE_DB=false

# Container image settings
CONTAINER_IMAGE_PULL=true
CONTAINER_REGISTRY=docker.io
CONTAINER_REGISTRY_USER=
CONTAINER_REGISTRY_PASSWORD=

# ============================================================
# Backup & Retention
# ============================================================
# Backup settings
BACKUP_ENABLED=true
BACKUP_SCHEDULE=daily
BACKUP_RETENTION_DAYS=90
BACKUP_DESTINATION=/backups

# ============================================================
# Alerting Rules
# ============================================================
# Alert thresholds
ALERT_CRITICAL_THRESHOLD=1
ALERT_HIGH_THRESHOLD=5
ALERT_MEDIUM_THRESHOLD=20
ALERT_INFO_THRESHOLD=100

# Alert aggregation window (seconds)
ALERT_AGGREGATION_WINDOW=60

# ============================================================
# Performance Tuning
# ============================================================
# Container memory limits
ELASTICSEARCH_MEMORY=512m
KIBANA_MEMORY=256m
PROMETHEUS_MEMORY=256m
GRAFANA_MEMORY=256m

# Falco performance settings
FALCO_RING_BUFFER_SIZE=64
FALCO_CAPTURE_BUFFER_SIZE=4194304

# ============================================================
# Data Retention
# ============================================================
# Elasticsearch index lifecycle
INDEX_ROTATION=daily
HOT_PHASE_DAYS=7
WARM_PHASE_DAYS=30
COLD_PHASE_DAYS=90
DELETE_PHASE_DAYS=365

# ============================================================
# TLS/SSL Configuration
# ============================================================
ENABLE_TLS=false
TLS_CERT_PATH=/certs/server.crt
TLS_KEY_PATH=/certs/server.key
TLS_CA_PATH=/certs/ca.crt

# ============================================================
# Authentication
# ============================================================
AUTH_ENABLED=false
AUTH_TYPE=basic  # basic, oauth, ldap, saml
LDAP_URL=ldap://ldap.company.com
LDAP_BIND_DN=cn=admin,dc=company,dc=com
LDAP_PASSWORD=

# ============================================================
# Audit Logging
# ============================================================
AUDIT_LOGGING_ENABLED=true
AUDIT_LOG_FILE=/var/log/audit/security-audit.log
AUDIT_RETENTION_DAYS=365

# ============================================================
# Integration Endpoints
# ============================================================
# SIEM Integration
SIEM_ENABLED=false
SIEM_URL=https://siem.company.com:8080
SIEM_API_KEY=

# Threat Intelligence Feed
THREAT_INTEL_ENABLED=true
THREAT_INTEL_FEED_URL=https://feeds.company.com/threats

# ============================================================
# Feature Flags
# ============================================================
FEATURE_MACHINE_LEARNING=true
FEATURE_ANOMALY_DETECTION=true
FEATURE_BEHAVIORAL_ANALYTICS=true
FEATURE_AUTO_REMEDIATION=false
FEATURE_INCIDENT_RESPONSE=true
FEATURE_FORENSIC_CAPTURE=true

# ============================================================
# Development Settings (Only for non-production)
# ============================================================
DEV_MODE=false
DEV_ENABLE_SAMPLING=false
DEV_ALERT_RATE_LIMIT=1000
